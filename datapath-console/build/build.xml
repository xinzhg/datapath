<?xml version="1.0" encoding="UTF-8"?>
<!--
  Datapath-Console Build Script
 
  @author Praveen Salitra (psalitra@cise.ufl.edu)
 
-->

<project basedir=".." name="datapath-console" default="all">
    
    <property name="build.dir" value="build/classes" />
    <property name="config.dir" value="config" />
    <property name="externals.dir" value="externals" />
    <property name="lib.dir" value="lib" />
    <property name="war.name" value="datapath-console.war" />
    
    <target name="init">
        <mkdir dir="${build.dir}"/>
        <mkdir dir="${lib.dir}"/>
    </target>
    
    
    <!-- COMPILE ALL JAVA CODE -->
    <target name="compile" depends="init">
        <javac srcdir="src" debug="on" debuglevel="lines,source,vars" destdir="${build.dir}" encoding="latin1">
          <classpath>
            <fileset dir="${externals.dir}">
              <include name="**/*.jar"/>
            </fileset>
          </classpath>
          <include name="**/*.java"/>
        </javac>
    </target>
    
    <!-- PACK EVERYTHING IN A WAR FILE -->
    <target name="build" depends="compile">
        <war destfile="${lib.dir}/${war.name}" needxmlfile="false">
            <classes dir="${build.dir}">
                <include name="**/*.class"/>
            </classes>
            <lib dir="externals">
                <include name="*.jar"/>
                <!-- servlet-api-2.5.jar is only required here for compilation
                     because tomcat already includes this jar on runtime. -->
                <exclude name="servlet-api-3.0.jar"/>
            </lib>
        	<fileset dir="web">
                <include name="*.jsp"/>
                <include name="*.html"/>
                <include name="resources/**/*.js"/>
                <include name="resources/**/*.css"/>
                <include name="resources/**/*.png"/>
                <include name="resources/**/*.gif"/>
                <include name="resources/**/*.jpg"/>        		
            </fileset>
        </war>
    </target>
    
    <!-- DEAFULT TARGET -->
    <target name="all" depends="build"/>
    
    <!-- CLEAN -->
    <target name="clean">
        <delete dir="${build.dir}"/>
        <delete file="${lib.dir}/${war.name}"/>
    </target>
    
</project>
